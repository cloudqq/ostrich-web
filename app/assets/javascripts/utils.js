// Generated by CoffeeScript 1.6.2
(function() {
  var $;

  $ = jQuery;

  $.fn.easyTable = function(options, adv_options) {
    var dom_def, dom_ref, name, oTable, settings, table_def, table_id, _i, _len, _ref;

    table_id = "tbid_" + new Date().getTime() + +"";
    if (options.table_id !== void 0) {
      table_id = options.table_id;
    } else {
      table_id = table_id;
    }
    if (options.column_names !== void 0) {
      table_def = '<table id="' + table_id + '" cellspacing="0" cellpadding="0" border="0" class="table table-striped table-bordered" width="100%"><thead>';
      _ref = options.column_names;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        name = _ref[_i];
        table_def += "<th>" + name + "</th>";
      }
      table_def += "</thead><tbody></tbody></table>";
    }
    this.html(table_def);
    dom_def = 'rt';
    if (options.search) {
      dom_ref = '<"top">f>rt';
    }
    if (options.paging) {
      dom_ref += '<"bottom"ilp><"clear">';
    }
    settings = {
      fnServerData: function(url, data, callback, oSettings) {
        return oSettings.jqXHR = $.ajax({
          url: oSettings.sAjaxSource || options.url,
          type: "GET",
          dataType: "json",
          data: data,
          success: callback,
          error: function(xhr, error, thrown) {
            return alert('error');
          }
        });
      },
      bPaginate: false,
      sDom: 'T<"clear">lfrtip',
      sPaginationType: "bootstrap",
      bServerSide: true,
      bProcessing: true,
      aaSorting: [],
      aoColumnDefs: [
        {
          bSortable: false,
          aTargets: []
        }
      ],
      sAjaxSource: options.url,
      oLanguage: {
        sSearch: "条件过滤",
        sInfo: "_START_-_END_ 总数 _TOTAL_",
        oPaginate: {
          sNext: "下页",
          sPrevious: "上页"
        }
      }
    };
    if (options.sorting !== void 0) {
      settings.aaSorting = options.sorting;
    }
    if (options.server_side !== void 0) {
      settings.bServerSide = options.server_side;
    }
    if (options.paging !== void 0) {
      settings.bPaginate = options.paging;
    }
    if (options.dom !== void 0) {
      settings.sDom = options.dom;
    }
    if (adv_options !== void 0) {
      settings = $.extend(settings, adv_options);
    }
    return oTable = this.children('table').dataTable(settings);
  };

}).call(this);
